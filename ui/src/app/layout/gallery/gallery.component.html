<div class="p-4" [@routerTransition]>
  <div>
    <app-page-header [breadCrumbs]="breadcrumbs"></app-page-header>
  </div>


  <main class="page" *tdLoading="'loading';strategy:'overlay'">
    <section class="shopping-cart dark">

      <div>
        <ng-container *ngIf="(entities$|async)?.length!=0 else anonymous">
          <div class="content">
            <form class="container-fluid">
              <div class="row ">

                <!-- Cart Items Table -->
                <div class="col-md-12 px-0">
                  <div class="items">

                    <!-- One Item Row -->
                    <div class="custom-card mt-3 p-3" *ngFor="let entity of entities$ | async ; index as i">
                      <div class="row">
                        <div class="col-md-3 service-image mb-3 mb-md-0">

                          <img class="img-fluid " [src]="appConfig.FILE_URL + entity.files[0].asset_id"
                            *ngIf="getFileExtension(entity) == 'image';else stlExtension">
                          <ng-template #stlExtension>
                            <div *ngIf="getFileExtension(entity) == 'stl';else serviceImage">
                              <img class="img-fluid " [src]="appConfig.serviceImage(entity.service)">
                              <app-stl-modal [stlPath]="appConfig.FILE_URL + entity.files[0].asset_id"></app-stl-modal>
                            </div>
                          </ng-template>
                          <ng-template #serviceImage>
                            <img class="img-fluid " [src]="appConfig.serviceImage(entity.service)">
                          </ng-template>
                        </div>
                        <div class="col-md-9">
                          <div class="container-fluid">

                            <div class="row pb-3 border-bottom">
                              <div class="col-md-4 my-auto">
                                <h5 class="mb-md-0 site-color-v4 f-weight-600 f-size-20">
                                  {{entity.service.name}}
                                </h5>
                              </div>
                              <div class="col-md-8 my-auto f-weight-600">
                                <div class="text-md-right text-center">
                                  <a class="btn btn-outline-success btn-xs " [href]="getFileUrl(entity)"
                                    tooltip="{{'download' | translate}}" hide-delay="0">
                                    <i class="fa fa-download" aria-hidden="true"></i>
                                  </a>
                                  <button *isAdmin (click)="removeItem(entity.id,i)"
                                    tooltip="{{'delete' | translate}}" hide-delay="0"
                                    aria-label="Example icon button with a delete icon"
                                    class="btn btn-outline-danger btn-xs ml-3">
                                    <i class="fa fa-trash" aria-hidden="true"></i>
                                  </button>
                                  <button color="primary" class="custom-btn v1 ml-3 mt-2 mt-md-0"
                                    tooltip="{{'addToCart' | translate}}" hide-delay="0"
                                    (click)="addLineItem(entity)">
                                    <i class="fa fa-cart-plus" aria-hidden="true"></i> {{'addToCart'|translate}}
                                  </button>
                                </div>
                              </div>
                            </div>

                            <!-- <div class="row">
                              <div class="col-md-12 product-name">
                                <div class="product-name">

                                  <div class="product-info row ">
                                    <section class="col-md-12 my-auto">
                                      <div *ngIf="entity.notes"><label>{{ 'notes' | translate }} :&nbsp;</label>
                                        <span>{{(entity.notes.length>80)? (entity.notes | slice:0:80)+'....':(entity.notes)}}</span>
                                      </div>
                                      <div><label>{{ 'quantity' | translate }} :&nbsp;</label>
                                        <span>{{entity.quantity}}</span>
                                      </div>
                                    </section>

                                  </div>
                                </div>
                              </div>
                            </div> -->

                            <div class="mt-3 f-size-14 f-weight-600 text-grey-v2" *ngFor="let file of entity.files ;index as j">
                              <div class=" row">
                                <div class="col-md-6 " *ngIf="file.height">
                                  <div><label class="site-color-v5">{{'file.height' | translate }} :&nbsp;</label>
                                    <span>{{file.height }}</span>
                                  </div>
                                </div>
                                <div class="col-md-6 " *ngIf="file.width">
                                  <div><label class="site-color-v5">{{'file.width' | translate }} :&nbsp;</label> <span>{{file.width }}</span>
                                  </div>
                                </div>
                                <div class="col-md-6 " *ngIf="file.material">
                                  <div><label class="site-color-v5">{{'file.material' | translate }} :&nbsp;</label>
                                    <span>{{file.material }}</span>
                                  </div>
                                </div>
                                <div class="col-md-6 " *ngIf="file.color">
                                  <div><label class="site-color-v5">{{'file.color' | translate }} :&nbsp;</label> <span>{{file.color }}</span>
                                  </div>
                                </div>
                                <div class="col-md-6 " *ngIf="file.thickness">
                                  <div><label class="site-color-v5">{{'file.thickness' | translate }} :&nbsp;</label>
                                    <span>{{file.thickness }}</span>
                                  </div>
                                </div>
                                <div class="col-md-6 " *ngIf="file.type">
                                  <div><label class="site-color-v5">{{'file.type' | translate }} :&nbsp;</label><span>{{file.type }}</span>
                                  </div>
                                </div>
                                <div class="col-md-6 " *ngIf="file.unit">
                                  <div><label class="site-color-v5">{{'file.unit' | translate }} :&nbsp;</label><span>{{file.unit }}</span>
                                  </div>
                                </div>
                                <div class="col-md-6 " *ngIf="file.processes">
                                  <div><label class="site-color-v5">{{'file.processes' | translate }} :&nbsp;</label>
                                    <span>{{file.processes }}</span>
                                  </div>
                                </div>

                              </div>
                            </div>



                          </div>
                        </div>
                      </div>

                    </div>
                    <!-- End One Item Row -->

                  </div>
                </div>
                <!-- End Cart Items Table -->


              </div>
              <div class="d-flex justify-content-between p-2">
                <ngb-pagination [collectionSize]="(total$ | async)!" [(page)]="service.page"
                  [pageSize]="service.pageSize">
                </ngb-pagination>

                <select class="custom-select" style="width: auto" name="pageSize" [(ngModel)]="service.pageSize">
                  <option [ngValue]="10">10 items per page</option>
                  <option [ngValue]="25">25 items per page</option>
                  <option [ngValue]="50">50 items per page</option>
                </select>
              </div>

            </form>

          </div>
        </ng-container>
        <!-- End Page Content -->
        <ng-template #anonymous>
          <div class="text-center">
            {{'please Select Service To Create Your ShoppingCart'|translate}}

          </div>
        </ng-template>

      </div>
    </section>
  </main>
</div>
